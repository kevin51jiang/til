<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <title>
      til / how to have multiple versions of cuda installed on linux — Kevin Jiang
    </title>
    <meta property="og:url" content="https://kevinjiang.ca/til/how-to-have-multiple-versions-of-cuda-installed-on-linux/">
    <meta property="og:title" content="til / how to have multiple versions of cuda installed on linux — Kevin Jiang">
    <meta property="og:description" content="Add the following to your  or ">
    <meta property="og:type" content="article">
    <meta property="article:author:first_name" content="Kevin">
    <meta property="article:author:last_name" content="Jiang">
    <meta property="article:published_time" content="2025-06-13T20:44:59.000-07:00">
    <meta property="article:modified_time" content="2025-06-14T05:00:59.000+00:00">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="@kevin51jiang">
    <script type="application/ld+json">
{
  "@context": "https://schema.org/",
  "@type": "LearningResource",
  "name": "how to have multiple versions of cuda installed on linux",
  "description": "Add the following to your  or ",
  "author": {
    "@type": "Person",
    "name": "Kevin Jiang",
    "url": "https://kevinjiang.ca"
  },
  "url": "https://kevinjiang.ca/til/how-to-have-multiple-versions-of-cuda-installed-on-linux/",
  "datePublished": "2025-06-13T20:44:59.000-07:00",
  "dateModified": "2025-06-14T05:00:59.000+00:00",
  "keywords": "cuda",
  "isPartOf": "https://kevinjiang.ca/til/",
  "license": "https://creativecommons.org/licenses/by/4.0/"
}
</script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="https://kevinjiang.ca/til/how-to-have-multiple-versions-of-cuda-installed-on-linux/">
    <link rel="shortcut icon" href="../assets/favicon.png">
    <link rel="stylesheet" href="../assets/style.css">
    <link rel="alternate" type="application/atom+xml" title="Reader Feed" href="https://kevinjiang.ca/til/feed.xml">
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-61714711-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-61714711-1');
    </script>
  </head>
  <body>
    <header>
      <a href="https://kevinjiang.ca/til/"><img src="../assets/logo.svg" alt="Kevin Jiang"></a>
    </header>
    <article>
      <h1>
        <a href="../">til</a><span>how to have multiple versions of cuda installed on linux</span>
      </h1>
      <h2 id="steps">
        <a href="#steps" data-anchor>Steps</a>
      </h2>
      <h3 id="one-time-setup">
        <a href="#one-time-setup" data-anchor>One-time setup</a>
      </h3>
      <ol start="1">
        <li>
          <p>
            Add the following to your <code>~/.bashrc</code> or <code>~/.zshrc</code>
          </p>
        </li>
      </ol>
      <pre data-code-block data-lang="bash"><code><span data-line="1"><span style="color:#D32F2F;">function</span><span style="color:#24292EFF;"> </span><span style="color:#6F42C1;">_switch_cuda</span><span style="color:#24292EFF;"> {</span>
</span><span data-line="2"><span style="color:#24292EFF;">   </span><span style="color:#D32F2F;">if</span><span style="color:#24292EFF;"> [ $# </span><span style="color:#D32F2F;">-eq</span><span style="color:#24292EFF;"> 0 ]</span><span style="color:#D32F2F;">;</span><span style="color:#24292EFF;"> </span><span style="color:#D32F2F;">then</span>
</span><span data-line="3"><span style="color:#24292EFF;">       </span><span style="color:#6F42C1;">echo</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">&quot;Available CUDA versions:&quot;</span>
</span><span data-line="4"><span style="color:#24292EFF;">       find /usr/local -maxdepth 1 -type d -name </span><span style="color:#22863A;">&quot;cuda-*&quot;</span><span style="color:#24292EFF;"> </span><span style="color:#D32F2F;">|</span><span style="color:#24292EFF;"> </span><span style="color:#D32F2F;">while</span><span style="color:#24292EFF;"> </span><span style="color:#6F42C1;">read</span><span style="color:#24292EFF;"> cuda_dir</span><span style="color:#D32F2F;">;</span><span style="color:#24292EFF;"> </span><span style="color:#D32F2F;">do</span>
</span><span data-line="5"><span style="color:#24292EFF;">           </span><span style="color:#6F42C1;">echo</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">&quot;  ${cuda_dir</span><span style="color:#D32F2F;">##*/</span><span style="color:#22863A;">}&quot;</span>
</span><span data-line="6"><span style="color:#24292EFF;">       </span><span style="color:#D32F2F;">done</span>
</span><span data-line="7"><span style="color:#24292EFF;">       </span><span style="color:#6F42C1;">echo</span><span style="color:#24292EFF;"> -e </span><span style="color:#22863A;">&quot;\nCurrently active CUDA version:&quot;</span>
</span><span data-line="8"><span style="color:#24292EFF;">       </span><span style="color:#D32F2F;">if</span><span style="color:#24292EFF;"> </span><span style="color:#6F42C1;">command</span><span style="color:#24292EFF;"> -v nvcc </span><span style="color:#D32F2F;">&gt;</span><span style="color:#24292EFF;">/dev/null </span><span style="color:#D32F2F;">2&gt;&amp;1;</span><span style="color:#24292EFF;"> </span><span style="color:#D32F2F;">then</span>
</span><span data-line="9"><span style="color:#24292EFF;">           nvcc --version </span><span style="color:#D32F2F;">|</span><span style="color:#24292EFF;"> grep </span><span style="color:#22863A;">&quot;release&quot;</span><span style="color:#24292EFF;"> </span><span style="color:#D32F2F;">|</span><span style="color:#24292EFF;"> awk </span><span style="color:#22863A;">'{print $5}'</span>
</span><span data-line="10"><span style="color:#24292EFF;">       </span><span style="color:#D32F2F;">else</span>
</span><span data-line="11"><span style="color:#24292EFF;">           </span><span style="color:#6F42C1;">echo</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">&quot;  No CUDA version currently active (nvcc not found)&quot;</span>
</span><span data-line="12"><span style="color:#24292EFF;">       </span><span style="color:#D32F2F;">fi</span>
</span><span data-line="13"><span style="color:#24292EFF;">       </span><span style="color:#D32F2F;">return</span>
</span><span data-line="14"><span style="color:#24292EFF;">   </span><span style="color:#D32F2F;">fi</span>
</span><span data-line="15">
</span><span data-line="16"><span style="color:#24292EFF;">   v=$1</span>
</span><span data-line="17"><span style="color:#24292EFF;">   </span><span style="color:#D32F2F;">if</span><span style="color:#24292EFF;"> [ </span><span style="color:#D32F2F;">!</span><span style="color:#24292EFF;"> </span><span style="color:#D32F2F;">-d</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">&quot;/usr/local/cuda-$v&quot;</span><span style="color:#24292EFF;"> ]</span><span style="color:#D32F2F;">;</span><span style="color:#24292EFF;"> </span><span style="color:#D32F2F;">then</span>
</span><span data-line="18"><span style="color:#24292EFF;">       </span><span style="color:#6F42C1;">echo</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">&quot;Error: CUDA version $v not found in /usr/local/cuda-$v. Syntax: _switch_cuda MAJOR.MINOR e.g. _switch_cuda 12.1&quot;</span>
</span><span data-line="19"><span style="color:#24292EFF;">       </span><span style="color:#D32F2F;">return</span><span style="color:#24292EFF;"> 1</span>
</span><span data-line="20"><span style="color:#24292EFF;">   </span><span style="color:#D32F2F;">fi</span>
</span><span data-line="21">
</span><span data-line="22"><span style="color:#24292EFF;">   </span><span style="color:#D32F2F;">export</span><span style="color:#24292EFF;"> PATH=$PATH:/usr/local/cuda-$v/bin</span>
</span><span data-line="23"><span style="color:#24292EFF;">   </span><span style="color:#D32F2F;">export</span><span style="color:#24292EFF;"> CUDADIR=/usr/local/cuda-$v</span>
</span><span data-line="24"><span style="color:#24292EFF;">   </span><span style="color:#D32F2F;">export</span><span style="color:#24292EFF;"> LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda-$v/lib64</span>
</span><span data-line="25">
</span><span data-line="26"><span style="color:#24292EFF;">   </span><span style="color:#D32F2F;">if</span><span style="color:#24292EFF;"> </span><span style="color:#6F42C1;">command</span><span style="color:#24292EFF;"> -v nvcc </span><span style="color:#D32F2F;">&gt;</span><span style="color:#24292EFF;">/dev/null </span><span style="color:#D32F2F;">2&gt;&amp;1;</span><span style="color:#24292EFF;"> </span><span style="color:#D32F2F;">then</span>
</span><span data-line="27"><span style="color:#24292EFF;">       nvcc --version</span>
</span><span data-line="28"><span style="color:#24292EFF;">   </span><span style="color:#D32F2F;">else</span>
</span><span data-line="29"><span style="color:#24292EFF;">       </span><span style="color:#6F42C1;">echo</span><span style="color:#24292EFF;"> </span><span style="color:#22863A;">&quot;Error: nvcc not found after switching to CUDA $v&quot;</span>
</span><span data-line="30"><span style="color:#24292EFF;">       </span><span style="color:#D32F2F;">return</span><span style="color:#24292EFF;"> 1</span>
</span><span data-line="31"><span style="color:#24292EFF;">   </span><span style="color:#D32F2F;">fi</span>
</span><span data-line="32"><span style="color:#24292EFF;">}</span>
</span></code></pre>
      <h3 id="for-each-cuda-install">
        <a href="#for-each-cuda-install" data-anchor>For each CUDA install…</a>
      </h3>
      <ol start="1">
        <li>
          <p>
            Download the right runfile from <a href="https://developer.nvidia.com/cuda-toolkit-archive" target="_blank">Nvidia’s CUDA Toolkit Archive</a>
          </p>
        </li>
        <li>
          <p>
            Select the right architecture for your computer. <em>Make sure to choose the runfile and not the .deb.</em>
          </p>
          <ul>
            <li>
              <p>
                For me, I did Linux &gt; x86_64 &gt; Ubuntu &gt; 22.04 &gt; runfile (local)
              </p>
            </li>
          </ul>
        </li>
        <li>
          <p>
            Use the provided wget command to download the runfile
          </p>
          <ul>
            <li>
              <p>
                e.g. <code>wget https://developer.download.nvidia.com/compute/cuda/12.1.1/local_installers/cuda_12.1.1_530.30.02_linux.run</code>
              </p>
            </li>
          </ul>
        </li>
        <li>
          <p>
            Install the cuda
          </p>
          <ul>
            <li>
              <p>
                <code>sudo sh cuda_12.1.1_530.30.02_linux.run --silent --toolkit --toolkitpath=/usr/local/cuda-12.1</code>
              </p>
            </li>
          </ul>
        </li>
      </ol>
      <p>
        Done!
      </p>
      <p>
        Then before you need to use CUDA, or after you enter your python venv you can just <code>_switch_cuda 12.1</code>.
      </p>
      <p>
        Alternatively, after you have the runfile URL, you can just paste it in this generator instead of editing the commands yourself.
      </p>
      <iframe src="https://kevinjiang.ca/install-cuda-script/" width="500" height="600" frameborder="0" style="border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: block; margin: 20px auto;" title="CUDA Installation Command Generator"></iframe>
      <h2 id="references">
        <a href="#references" data-anchor>References</a>
      </h2>
      <p>
        I originally followed the tutorial here ”<a href="https://notesbyair.github.io/blog/cs/2020-05-26-installing-multiple-versions-of-cuda-cudnn/" target="_blank">https://notesbyair.github.io/blog/cs/2020-05-26-installing-multiple-versions-of-cuda-cudnn/</a>” but that disappeared so I’m writing my own.
      </p>
      <ul>
        <li>
          <p>
            Archive link is here: <a href="https://web.archive.org/web/20220129002741/https://notesbyair.github.io/blog/cs/2020-05-26-installing-multiple-versions-of-cuda-cudnn/" target="_blank">https://web.archive.org/web/20220129002741/https://notesbyair.github.io/blog/cs/2020-05-26-installing-multiple-versions-of-cuda-cudnn/</a>
          </p>
        </li>
      </ul>
      <p>
        Differences:
      </p>
      <ul>
        <li>
          <p>
            we’re installing cuda more than cudnn since I only run ML workflows
          </p>
        </li>
        <li>
          <p>
            the <code>_switch_cuda</code> by itself will list versions installed, and the currently active one. Previously it would be easy to forget which versions were installed.
          </p>
        </li>
      </ul>
      <p>
        I’m running on Linux Mint so I’m used to the apt world. Unix wizards need not apply.
      </p>
    </article>
    <footer>
      <div class="linkedlist">
        <a href="../how-to-make-claude-play-pokemon/" class="prev">how to make claude play pokemon</a>
      </div>
      <div class="license" xmlns:cc="http://creativecommons.org/ns" xmlns:dct="http://purl.org/dc/terms/">
        This <a property="dct:title" rel="cc:attributionURL" href="https://kevinjiang.ca/til/how-to-have-multiple-versions-of-cuda-installed-on-linux/">til</a> was created <span property="dct:created" content="2025-06-13T20:44:59.000-07:00">Fri, Jun 13, 2025, 8:44 PM</span> ⸱ <a href="https://raw.githubusercontent.com/kevin51jiang/til/main/entries/how%20to%20have%20multiple%20versions%20of%20cuda%20installed%20on%20linux.md" target="_blank">raw</a> ⸱ <a href="https://github.com/kevin51jiang/til/edit/main/entries/how%20to%20have%20multiple%20versions%20of%20cuda%20installed%20on%20linux.md#L8" target="_blank">edit</a><br>© <span rel="dct:dateCopyrighted">2025</span> <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://kevinjiang.ca">Kevin Jiang</a> ⸱ licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank" rel="cc:license license noopener noreferrer">CC BY 4.0<img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" aria-hidden="true"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" aria-hidden="true"></a> ⸱ <a href="https://kevinjiang.ca/til/feed.xml" rel="alternate feed" type="application/atom+xml">feed</a>
      </div>
    </footer>
  </body>
</html>